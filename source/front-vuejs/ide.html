<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <base href="/dashboard/" />
    <title>PequeRoku â€“ Micro-IDE</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css"
    />
    <link rel="icon" href="/dashboard/favicon.svg" type="image/svg+xml" />
    <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css"
    />
  </head>
  <body>
    <header>
      <h1>PequeRoku</h1>
      <div class="user-info">
        <div>
          <div class="dropdown header-dropdown">
            <a href="/">
              <button class="header-button">
                <i class="iconoir-long-arrow-down-left"></i>
              </button>
            </a>
          </div>
        </div>
      </div>
    </header>

    <main id="editor-modal" class="full-viewport-height calc">
      <div class="sidebar" id="sidebar">
        <div id="tree-toolbar" class="toolbar">
          <button id="refresh-tree" title="Reload">
            <i class="iconoir-restart"></i>
          </button>
          <button id="new-folder" title="Create Folder">
            <i class="iconoir-folder-plus"></i>
          </button>
          <button id="new-file" title="Create file">
            <i class="iconoir-multiple-pages-plus"></i>
          </button>
          <button id="btn-open-upload-modal" title="Upload file">
            <i class="iconoir-cloud-upload"></i>
          </button>
          <button id="btn-download" title="Download folder">
            <i class="iconoir-cloud-download"></i>
          </button>
          <button id="toggle-search" title="Toggle search">
            <i class="iconoir-search"></i>
          </button>
          <button id="toggle-preview" title="Toggle preview">
            <i class="iconoir-globe"></i>
          </button>
          <button id="toggle-sidebar-2" class="hidden-big" title="Toggle sidebar">
            <i class="iconoir-menu"></i>
          </button>
        </div>
        <div id="search-box" class="search-box hidden">
          <div class="toolbar" id="search-toolbar">
            <input
              id="search-pattern"
              type="text"
              placeholder="Search in files..."
              autocomplete="off"
            />
            <button id="btn-search" title="Search">
              <i class="iconoir-search"></i>
            </button>
            <label class="toggle-case" title="Case-sensitive">
              <input id="search-case" type="checkbox" />
              <i class="iconoir-text-size"></i>
            </label>
            <button id="btn-search-clear" title="Clear results">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="toolbar" id="search-advanced">
            <input
              id="search-include"
              type="text"
              placeholder="Include globs (comma separated)"
              autocomplete="off"
            />
            <input
              id="search-exclude"
              type="text"
              placeholder="Exclude dirs (comma separated)"
              value=".git,.venv"
              autocomplete="off"
            />
          </div>
          <ul id="search-results" class="search-results"></ul>
        </div>
        <div id="preview-box" class="preview-box hidden">
          <div class="toolbar" id="preview-toolbar">
            <input
              id="preview-url"
              type="text"
              placeholder="https://example.com"
              autocomplete="off"
            />
            <button id="btn-preview-go" title="Go">
              <i class="iconoir-arrow-right"></i>
            </button>
            <button id="btn-preview-refresh" title="Refresh">
              <i class="iconoir-reload-window"></i>
            </button>
            <button id="btn-preview-popout" title="Open in new tab">
              <i class="iconoir-open-new-window"></i>
            </button>
          </div>
          <iframe
            id="preview-iframe"
            src="about:blank"
            frameborder="0"
            style="width: 100%; height: 30vh"
          ></iframe>
        </div>
        <ul id="file-tree"></ul>
      </div>

      <div class="splitter-v resizer" id="splitter-v"></div>
      <div class="main" id="main">
        <div class="toolbar">
          <div>
            <span id="current_path_label"></span>
            <div id="file-tabs" class="file-tabs" role="tablist" aria-label="Open files"></div>
          </div>
          <div>
            <button id="save-file" title="Save file">
              <i class="iconoir-floppy-disk"></i>
            </button>
            <button id="run-code" title="Run">
              <i class="mod-iconoir iconoir-play"></i> Run
            </button>
          </div>
        </div>
        <div id="editor"></div>

        <div class="console-resizer resizer" id="splitter-h"></div>
        <div class="console-area" id="console-area">
          <div class="toolbar">
            <div class="tabs" id="console-tabs"></div>
            <div class="console-toolbar">
              <button id="btn-open-session" title="Create shell">
                <i class="iconoir-terminal-outline"></i>
              </button>
              <button id="btn-close-session" title="Close shell">
                <i class="iconoir-xmark-circle"></i>
              </button>
              <button id="btn-toggle-ai" title="Toggle AI chat">
                <i class="iconoir-spark"></i>
              </button>
              <button id="restart-container" title="Restart container">
                <i class="iconoir-reload-window"></i>
              </button>
              <button id="btn-open-session-history" title="Session history">
                <i class="iconoir-list"></i>
              </button>
            </div>
          </div>
          <div id="console"></div>
        </div>
      </div>

      <div id="sidebar-2" class="sidebar-2 hidden">
        <div class="toolbar">
          <div class="tabs" id="sidebar-2-tabs"></div>
          <button id="toggle-sidebar-2-close" title="Close">
            <i class="iconoir-xmark-circle"></i>
          </button>
        </div>
        <div class="sidebar-2-body">
          <div class="sidebar-tab hidden" id="sidebar-2-templates">
            <div class="upload-header">
              <span>Templates</span>
              <button id="btn-open-templates-modal" class="btn-secondary">
                Browse
              </button>
            </div>
            <div id="tpl-container"></div>
          </div>
          <div class="sidebar-tab hidden" id="sidebar-2-ai">
            <div class="upload-header">
              <span>AI assistant</span>
              <button id="btn-open-ai-modal" class="btn-secondary" title="Open modal">
                <i class="iconoir-open-new-window"></i>
              </button>
            </div>
            <div id="ai-chat"></div>
          </div>
          <div class="sidebar-tab hidden" id="sidebar-2-search">
            <div class="upload-header">
              <span>Search</span>
              <button id="btn-search-close" class="btn-secondary" title="Close">
                <i class="iconoir-xmark-circle"></i>
              </button>
            </div>
            <div id="search-results-wrapper"></div>
          </div>
        </div>
      </div>

      <div id="ai-modal" class="modal hidden">
        <div class="modal-dialog large">
          <div class="modal-header">
            <span>AI assistant</span>
            <button id="btn-close-ai-modal" class="btn-secondary">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="modal-body">
            <div id="ai-chat-modal"></div>
          </div>
        </div>
      </div>

      <div id="templates-modal" class="modal hidden">
        <div class="modal-dialog large">
          <div class="modal-header">
            <span>Templates</span>
            <button id="btn-templates-close" class="btn-secondary">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="modal-body">
            <div style="display: flex; gap: 0.5rem; flex-wrap: wrap">
              <label class="checkbox">
                <input type="checkbox" id="tpl-clean" />
                Remove destination contents first
              </label>
              <label>
                Destination
                <input type="text" id="tpl-dest" value="/app" />
              </label>
            </div>
            <div id="tpl-list"></div>
          </div>
        </div>
      </div>

      <div id="upload-modal" class="modal hidden">
        <div class="modal-dialog">
          <div class="modal-header">
            <span>Upload file</span>
            <button id="btn-upload-close" class="btn-secondary">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="modal-body">
            <div class="upload-header">
              <span>Drop file</span>
              <label for="file-upload" class="btn-secondary">Browse</label>
              <input id="file-upload" type="file" />
            </div>
            <div class="upload-status" id="upload-status"></div>
          </div>
        </div>
      </div>

      <div id="github-modal" class="modal hidden">
        <div class="modal-dialog">
          <div class="modal-header">
            <span>Clone repository</span>
            <button id="btn-github-close" class="btn-secondary">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="modal-body">
            <label>
              Git repository URL
              <input type="text" id="git-url" placeholder="https://github.com/user/repo" />
            </label>
            <label>
              Destination folder
              <input type="text" id="git-dest" value="/app" />
            </label>
            <button id="btn-github-clone" class="btn-primary">Clone</button>
            <div class="muted" style="margin-top: 0.5rem">
              This will replace the contents of the destination folder.
            </div>
          </div>
        </div>
      </div>

      <div id="session-history-modal" class="modal hidden">
        <div class="modal-dialog large">
          <div class="modal-header">
            <span>Session history</span>
            <button id="btn-session-history-close" class="btn-secondary">
              <i class="iconoir-xmark-circle"></i>
            </button>
          </div>
          <div class="modal-body">
            <div id="session-history"></div>
          </div>
        </div>
      </div>
    </main>

    <div id="global-loader" class="loader-overlay hidden">
      <div class="loader-backdrop"></div>
      <div class="loader-spinner"></div>
    </div>

    <script type="module" src="/src/legacy/ide/main.js"></script>
  </body>
</html>
