<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <title>PequeRoku â€“ Micro-IDE</title>
        <link rel="stylesheet" href="/css/themes.css" />
        <link rel="stylesheet" href="/css/base.css" />
        <link rel="stylesheet" href="/css/ideStyles.css" />
        <link rel="stylesheet" href="/css/ai.css" />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/gh/iconoir-icons/iconoir@main/css/iconoir.css"
        />

        <script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    </head>

    <body>
        <header>
            <h1>PequeRoku</h1>
            <div class="user-info">
                <div>
                    <div class="dropdown header-dropdown">
                        <a href="/">
                            <button class="header-button">
                                <i
                                    class="iconoir-long-arrow-down-left"
                                ></i></button
                        ></a>
                    </div>
                </div>
            </div>
        </header>

        <main id="editor-modal" class="full-viewport-height calc">
            <div class="sidebar" id="sidebar">
                <div class="toolbar" style="justify-content: normal;">
                    <button id="refresh-tree" title="Reload">
                        <i class="iconoir-restart"></i>
                    </button>
                    <button id="new-folder" title="Create Folder">
                        <i class="iconoir-folder-plus"></i>
                    </button>
                    <button id="new-file" title="Create file">
                        <i class="iconoir-multiple-pages-plus"></i>
                    </button>
                    <button id="btn-open-upload-modal" title="Upload file">
                        <i class="iconoir-cloud-upload"></i>
                    </button>
                    <button id="btn-download" title="Download folder">
                        <i class="iconoir-cloud-download"></i>
                    </button>
                    <button
                        id="toggle-sidebar-2"
                        class="hidden-big"
                        title="Toggle sidebar"
                    >
                        <i class="iconoir-menu"></i>
                    </button>
                </div>
                <ul id="file-tree"></ul>
            </div>

            <div class="splitter-v resizer" id="splitter-v"></div>
            <div class="main" id="main">
                <div class="toolbar">
                    <div>
                        <span id="current_path_label"></span>
                        <div id="file-tabs" class="file-tabs" role="tablist" aria-label="Open files"></div>
                    </div>
                    <div>
                        <button id="save-file" title="Save file">
                            <i class="iconoir-floppy-disk"></i>
                        </button>
                        <button id="run-code" title="Run">
                            <i class="mod-iconoir iconoir-play"></i> Run
                        </button>
                    </div>
                </div>
                <div id="editor"></div>


                <div class="console-resizer resizer" id="splitter-h"></div>
                <div class="console-area" id="console-area">
                    <div class="toolbar">
                        <div id="console-tabs" class="console-tabs" role="tablist" aria-label="Console sessions"></div>
                        <button class="console-btn" id="btn-open-session" title="Open new console">New</button>
                        <button class="console-btn" id="btn-close-session" title="Close current console">Close</button>
                    </div>
                    <div class="console console-hiddable" id="console-log"></div>
                    <div class="toolbar console-toolbar console-hiddable">
                        <input
                            type="text"
                            id="console-cmd"
                            class="console-input"
                            placeholder="bash command..."
                            autocomplete="off"
                        />
                        <button class="console-btn" id="send-cmd">Send</button>
                        <div class="dropdown">
                            <button class="console-btn last-button">
                                <i class="iconoir-nav-arrow-down"></i>
                            </button>
                            <div class="dropdown-content">
                                <button class="btn-send" param="ctrld">
                                    Ctrl+D
                                </button>
                                <button class="btn-send" param="ctrlc">
                                    Ctrl+C
                                </button>
                                <button class="btn-send" param="clear">
                                    Clear
                                </button>
                                <button class="btn-send" id="restart-container">
                                    Reload console
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="bottom_bar toolbar" style="justify-content: space-between;">
                        <div>
                        <button id="toggle-sidebar" title="Toggle sidebar">
                            <i class="mod-iconoir-big iconoir-menu"></i> <span class="hidde-small">Toggle tree</span>
                        </button>
                        </div>
                        <div>
                            <button id="theme-toggle" title="Theme">
                                <i class="mod-iconoir-big iconoir-orthogonal-view"></i> <span class="hidde-small">Theme</span>
                            </button>
                            <button id="btn-open-templates-modal" title="Templates">
                                <i class="mod-iconoir-big iconoir-orthogonal-view"></i> <span class="hidde-small">Templates</span>
                            </button>
                            <button id="btn-clone-repo" title="Clone Repository">
                                <i class="mod-iconoir-big iconoir-github-circle"></i> <span class="hidde-small">Clone from Github</span>
                            </button>
                            <button id="btn-open-ai-modal" title="AI Features">
                                <i class="mod-iconoir-big iconoir-sparks"></i> AI
                            </button>
                            <button id="toggle-console" title="Toggle console">
                                <i class="mod-iconoir-big iconoir-terminal-tag"></i> <span class="hidde-small">Toggle console</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Clone from github -->
                <div id="github-modal" class="hidden">
                    <div class="upload-container">
                        <div class="upload-header">
                            <span>Clone from Github</span>
                            <button id="btn-github-close" class="top-btn">
                                <i class="iconoir-xmark-circle"></i>
                            </button>
                        </div>
                        <div class="upload-body" style="display: list-item;">
                            <label for="url_git">Git URL</label>
                            <br>
                            <input
                                id="url_git"
                                name="url_git"
                                type="text"
                                placeholder="/app"
                                value="https://github.com/HectorPulido/generic-portfolio"
                                style="width: 100%;"
                            />
                            <br><br>
                            <label for="base_path">
                                Base path
                            </label>
                            <br>
                            <input
                                id="base_path"
                                name="base_path"
                                type="text"
                                placeholder="/"
                                value="/"
                                style="width: 100%;"
                            />
                            <br><br>
                            <button id="btn-github" type="submit" value="Submit">Clone</button>
                        </div>
                    </div>
                </div>


                <!-- Upload modal -->
                <div id="upload-modal" class="hidden">
                    <div class="upload-container">
                        <div class="upload-header">
                            <span>Upload file</span>
                            <button id="btn-upload-close" class="top-btn">
                                <i class="iconoir-xmark-circle"></i>
                            </button>
                        </div>
                        <div class="upload-body">
                            <input type="file" id="file-input" />
                            <button id="btn-upload">Upload</button>
                        </div>
                    </div>
                </div>

                <!-- Templates modal -->
                <div id="templates-modal" class="hidden">
                    <div class="upload-container">
                        <div class="upload-header">
                            <span>Templates</span>
                            <button id="btn-templates-close" class="top-btn">
                                <i class="iconoir-xmark-circle"></i>
                            </button>
                        </div>
                        <div
                            class="upload-body"
                            style="display: block; overflow: auto"
                        >
                            <div hidden>
                                <label>Destination</label>
                                <input
                                    type="text"
                                    id="tpl-dest"
                                    placeholder="/app"
                                    value="/app"
                                    style="width: 160px"
                                />
                                <label
                                    style="
                                        display: flex;
                                        align-items: center;
                                        gap: 6px;
                                    "
                                >
                                    <input
                                        type="checkbox"
                                        id="tpl-clean"
                                        checked
                                    />
                                    clean
                                </label>
                            </div>
                            <div id="tpl-list"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ai-chat" class="hidden">
                <div class="chat" role="application" aria-label="Chatbot">
                    <div id="bot-header">
                        <div class="bot-title">
                            <div id="ai-dot" class="red-dot" aria-hidden="true"></div>
                            <h1>Chatbot</h1>
                        </div>
                        <div>
                            <button id="btn-ai-chat-close" class="top-btn">
                                <i class="iconoir-nav-arrow-down"></i>
                            </button>
                        </div>
                    </div>
                    <div class="hint">
                        <p id="ai-left">Welcome!</p>
                    </div>
                    <div id="messages" aria-live="polite" aria-atomic="false"></div>

                    <div id="reconnect" class="reconnect-composer" style="padding: 10px;max-width: 200px;">
                        <button id="ai-reconect">Reconect</button>
                    </div>

                    <form id="ai-composer" class="hidden" autocomplete="off">
                        <textarea id="chat-input" placeholder="Write a message..." aria-label="Write a message"></textarea>
                        <button id="ai-send" type="submit">Send</button>
                    </form>
                </div>
            </div>

            <!-- Context menu -->
            <ul id="finder-menu" class="context-menu hidden">
                <li data-action="open"><i class="iconoir-doc-magnifying-glass"></i> Open</li>
                <li data-action="rename"><i class="iconoir-text"></i> Rename...</li>
                <li data-action="delete" class="danger"><i class="iconoir-bin-minus-in"></i> Delete...</li>
                <li class="divider"></li>
                <li data-action="new-file"><i class="iconoir-multiple-pages-plus"></i> New file here...</li>
                <li data-action="new-folder"><i class="iconoir-folder-plus"></i> New folder here...</li>
                <li data-action="download"><i class="iconoir-cloud-download"></i> Download this...</li>
            </ul>

            <!-- Global loader -->
            <div id="global-loader" class="loader-overlay hidden">
                <div class="loader-backdrop"></div>
                <div class="loader-spinner"></div>
            </div>
        </main>

        <script type="module" src="/js/ide/main.js"></script>
        <script type="module" src="/js/ide/aiChat.js"></script>
    </body>
</html>
